angular.element(document).ready(function(){var a=document.getElementById("containerApp");angular.bootstrap(a,["containerApp"])});var containerApp=angular.module("containerApp",["ngRoute"]);containerApp.config(["$locationProvider",function(a){a.html5Mode(true)}]);containerApp.controller("requestController",["$scope","$http","$location","$window",function(a,f,e,d){var c=true;this.postRequestVote=function(i){if(c){c=false;$("#imageRequestUpvoteButton").addClass("voted");document.getElementById("imageRequestUpvoteButton").innerHTML=parseInt($("#imageRequestUpvoteButton").html())+1;var h={id:i};var g=document.forms.pp_request_api_patch_request_vote.action;f({method:"PATCH",url:g,data:JSON.stringify(h)}).then(function(j){c=true},function(j){console.log("Request failed : "+j.statusText);c=true})}};this.reportData={ticketType:1,targetId:null,reasonId:1,details:null};var b=false;this.postReport=function(h){if(!b){b=true;this.reportData.targetId=h;console.log(this.reportData);var g=document.forms.pp_report_api_post_report_ticket_form.action;f({method:"POST",url:g,data:JSON.stringify(this.reportData)}).then(function(i){},function(i){console.log("Request failed : "+i.statusText)})}};console.log(e);this.postDisableRequest=function(h){if(!b){b=true;this.reportData.targetId=h;console.log(this.reportData);var g=document.forms.pp_report_api_post_disable_ticket_form.action;f({method:"POST",url:g,data:JSON.stringify(this.reportData)}).then(function(i){d.location.href=e.$$absUrl},function(i){console.log("Request failed : "+i.statusText)})}}}]);containerApp.controller("propositionsController",["$scope","$http","$compile","$window",function(i,f,c,a){var g=null;this.init=function(k){j(k,1);g=k};var e="#loadPageTrigger2";var h=2;var j=function(m,l){document.getElementById("loadingGif").style.display="block";var k=document.forms["pp_request_api_get_request_proposition_form_"+l].action;f.get(k+".html").then(function(n){var o=angular.element(n.data);c(o)(i);angular.element(document.querySelector("#loadPage"+l)).append(o);document.getElementById("loadingGif").style.display="none"},function(n){console.log("Request failed : "+n.statusText)})};var d=true;this.postPropositionVote=function(k){if(d){d=false;$("#propositionUpvoteButton_"+k).addClass("voted");document.getElementById("propositionUpvoteButton_"+k).innerHTML=parseInt($("#propositionUpvoteButton_"+k).html())+1;var m={id:k};var l=document.forms.pp_proposition_api_patch_proposition_vote_form.action;f({method:"PATCH",url:l,data:JSON.stringify(m)}).then(function(n){d=true},function(n){console.log("Request failed : "+n.statusText);d=true})}};var b=false;this.postRequestSelect=function(k){var m={};var l=document.forms["pp_proposition_api_patch_request_select_form_"+k].action;if(!b){b=true;f({method:"PATCH",url:l,data:JSON.stringify(m)}).then(function(n){var o=JSON.parse(n.data);if(o.succes){a.location.href=o.redirect}},function(n){console.log("Request failed : "+n.statusText)})}};$(window).scroll(function(){if($(e).offset()!=null){var m=$(e).offset().top,n=$(e).outerHeight(),l=$(window).height(),k=$(this).scrollTop()}if(k>(m+n-l)){j(g,h);h++;e="#loadPageTrigger"+h}})}]);